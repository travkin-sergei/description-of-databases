{% extends 'base.html' %}
{% block title %}–ê–¥–º–∏–Ω–ø–∞–Ω–µ–ª—å{% endblock %}

{% block content %}
<h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>

<div class="row mb-4">
  <div class="col"><div class="alert alert-info">–í—Å–µ–≥–æ: {{ total }}</div></div>
  <div class="col"><div class="alert alert-success">–û–¥–æ–±—Ä–µ–Ω–æ: {{ approved }}</div></div>
  <div class="col"><div class="alert alert-warning">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏: {{ pending }}</div></div>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
      <th>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</th>
      <th>–û–¥–æ–±—Ä–µ–Ω</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
      <th>–¢–æ–∫–µ–Ω</th>
    </tr>
  </thead>
  <tbody>
    {% for p in profiles %}
    <tr class="{% if not p.is_approved %}table-warning{% endif %}">
      <td>{{ p.user.username }}<br><small>{{ p.user.email|default:"‚Äî" }}</small></td>
      <td>{{ p.created_at|date:"d.m.Y H:i" }}</td>
      <td>
        {% if p.is_approved %}
          <span class="badge bg-success">–î–∞</span>
        {% else %}
          <span class="badge bg-danger">–ù–µ—Ç</span>
        {% endif %}
      </td>
      <td>
        {% if not p.is_approved %}
          <a href="{% url 'app_auth:approve_user' p.user.id %}" class="btn btn-sm btn-success">‚úì</a>
        {% else %}
          <a href="{% url 'app_auth:reject_user' p.user.id %}" class="btn btn-sm btn-outline-danger">‚úó</a>
        {% endif %}
      </td>
      <td>
        {% with token=p.user.auth_token %}
          {% if token %}
            <code>{{ token.key|truncatechars:12 }}</code>
            <a href="{% url 'app_auth:regenerate_token' p.user.id %}" class="btn btn-sm btn-outline-secondary">üîÑ</a>
          {% else %}
            ‚Äî
          {% endif %}
        {% endwith %}
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="5" class="text-center">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}